data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)+
geom_text(aes(y=count+c(0,cumsum(count)[-length(count)]), label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)+
geom_text(aes(y=count/12+c(0,cumsum(count)[-length(count)]), label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)+
geom_text(aes(y=count/length(count)+c(0,cumsum(count)[-length(count)]), label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
mutate(prop=count/sum(count)*100) %>%
mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)+
geom_text(aes(y=ypos, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
scale_y_continuous(breaks = cumcum(count) - count*0.5, labels = landslide_type)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
scale_y_continuous(breaks = cumsum(count) - count*0.5, labels = landslide_type)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
scale_y_continuous(breaks = cumsum(count) - count*0.5, labels = count)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
scale_y_continuous(breaks = cumsum(count), labels = landslide_type)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
scale_y_continuous(breaks = cumsum(count), labels = landslide_type)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
scale_y_continuous(breaks = cumsum(count), labels = landslide_type)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
scale_y_continuous(breaks = cumsum(count/sum(count)*100), labels = landslide_type)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
geom_label(x=1.2, aes(y=cumsum(count)-count/2), label=count)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
geom_label(x=1.2, aes(y=cumsum(count)-count/2), label=count)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar(theta="y",start = 0)+
#geom_label(x=1.2, aes(y=cumsum(count)-count/2), label=count)
#scale_y_continuous(breaks = cumsum(count) - count*0.5, labels = landslide_type)
#geom_text(aes(y=ypos, label=percent(count/sum(count))),size=2)
# To check if there is a seasonality of occurrence of landslides
data %>%
group_by(year, month_ordered) %>%
summarize(count = n()) %>%
ggplot(aes(x = year, y = month_ordered)) +
ggtitle("Seasonality of occurence of landslides") +
geom_tile(aes(fill = count), colour = "white")
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)+
#geom_label(x=1.2, aes(y=cumsum(count)-count/2), label=count)
#scale_y_continuous(breaks = cumsum(count) - count*0.5, labels = landslide_type)
#geom_text(aes(y=ypos, label=percent(count/sum(count))),size=2)
# To check if there is a seasonality of occurrence of landslides
data %>%
group_by(year, month_ordered) %>%
summarize(count = n()) %>%
ggplot(aes(x = year, y = month_ordered)) +
ggtitle("Seasonality of occurence of landslides") +
geom_tile(aes(fill = count), colour = "white")
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)+
geom_label(x=1.2, aes(y=cumsum(count)-count/2), label=count)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)+
geom_label(x=1.2, aes(y=cumsum(count)-count/2), label=count)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)+
#geom_label(x=1.2, aes(y=cumsum(count)-count/2), label=count)
#mutate(prop=count/sum(count)*100) %>%
#mutate(ypos=cumsum(prop)-0.5*prop) %>%
#scale_y_continuous(breaks = cumsum(count) - count*0.5, labels = landslide_type)
geom_text(aes(y=ypos, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y",start = 0)+
geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y", start=30)+
geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)+count/2, label=percent(count/sum(count))),size=2)
-
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/4, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/12, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/24, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/100, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/500, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/1000, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
#geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
geom_text((aes(label=percent(count/sum(count)))), position = position_stack(vjust = 0.5))
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
#geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
geom_text((aes(label=percent(count/sum(count)))), position = position_stack(vjust = 0.5), size=2)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
#geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
geom_text((aes(label=percent(count/sum(count)))), position = position_stack(vjust = 0.5), size=3)
help("percent")
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
#geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
geom_text((aes(label=percent(count/sum(count),accuracy = 1))), position = position_stack(vjust = 0.5), size=3)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
#geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
geom_text((aes(label=percent(count/sum(count),accuracy = 2))), position = position_stack(vjust = 0.5), size=3)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
#geom_text(aes(y=cumsum(count)-count/2, label=percent(count/sum(count))),size=2)
geom_text((aes(label=percent(count/sum(count),accuracy = 0.01))), position = position_stack(vjust = 0.5), size=3)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide per type per year")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text((aes(label=percent(count/sum(count),accuracy = 0.01))), position = position_stack(vjust = 0.5), size=3)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide type")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text((aes(label=percent(count/sum(count),accuracy = 0.01))), position = position_stack(vjust = 0.5), size=3)
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide type")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text((aes(label=percent(count/sum(count),accuracy = 0.01))), position = position_stack(vjust = 0.5), size=3)
data%>%
group_by(trigger) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=trigger))+
ggtitle("Distribution of landslide type")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text((aes(label=percent(count/sum(count),accuracy = 0.01))), position = position_stack(vjust = 0.5), size=3)
# Distribution of landslide per type
data%>%
group_by(year) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=year))+
ggtitle("Distribution of landslide type")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text((aes(label=percent(count/sum(count),accuracy = 0.01))), position = position_stack(vjust = 0.5), size=3)
# Distribution of landslide per type
data%>%
group_by(year) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=year))+
ggtitle("Distribution of landslide type")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text((aes(label=percent(count/sum(count),accuracy = 0.01))), position = position_stack(vjust = 0.5), size=3)
landslide_type
# Distribution of landslide per type
data%>%
group_by(landslide_type) %>%
summarize(count = n()) %>%
ggplot(aes(x='', y=count, fill=landslide_type))+
ggtitle("Distribution of landslide type")+
geom_bar(stat = "identity")+
theme_void()+
coord_polar("y")+
geom_text((aes(label=percent(count/sum(count),accuracy = 0.01))), position = position_stack(vjust = 0.5), size=3)
library(ggplot2)
library(dplyr)
library(grid)
library(gridExtra)
library(tidyr)
library(glue)
library(scales)
data %>% select(month_ordered, year) %>%
group_by(month_ordered, year) %>%
summarize(count = n()) %>%
ggplot(aes(x = month_ordered, y = count)) +
xlab('Month') + ylab('Frequency') +
ggtitle("Seasonality of occurence of landslides") +
geom_boxplot(colour = 'black') +
geom_point()+
geom_smooth(method = 'lm', formula = y ~ poly(x, 2), color = 'blue', lty = 2, aes(group = 1))
data %>% select(month_ordered, year) %>%
group_by(month_ordered, year) %>%
summarize(count = n()) %>%
ggplot(aes(x = month_ordered, y = count)) +
xlab('Month') + ylab('Frequency') +
ggtitle("Seasonality of occurence of landslides") +
geom_boxplot(colour = 'black') +
geom_scatter()+
geom_smooth(method = 'lm', formula = y ~ poly(x, 2), color = 'blue', lty = 2, aes(group = 1))
data %>% select(month_ordered, year) %>%
group_by(month_ordered, year) %>%
summarize(count = n()) %>%
ggplot(aes(x = month_ordered, y = count)) +
xlab('Month') + ylab('Frequency') +
ggtitle("Seasonality of occurence of landslides") +
geom_boxplot(colour = 'black') +
geom_smooth(method = 'lm', formula = y ~ poly(x, 2), color = 'blue', lty = 2, aes(group = 1))
